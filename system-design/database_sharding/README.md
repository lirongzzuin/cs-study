# ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”© (Database Sharding)

## 1. ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”©ì´ë€?
ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”©(Database Sharding)ì€ **ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ê°œì˜ ì‘ì€ ë°ì´í„°ë² ì´ìŠ¤(ìƒ¤ë“œ, Shard)ë¡œ ë¶„í• í•˜ì—¬ ì €ì¥í•˜ëŠ” ìˆ˜í‰ í™•ì¥(Scale-Out) ê¸°ìˆ **ì´ë‹¤. ì´ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ì„±ëŠ¥ê³¼ í™•ì¥ì„±ì„ ë†’ì´ëŠ” ë° ì‚¬ìš©ëœë‹¤.

### ğŸ”¹ ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”©ì˜ ì£¼ìš” ëª©ì 
- **ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ ê°œì„ **: ë‹¨ì¼ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë¶€í•˜ë¥¼ ì¤„ì´ê³  íŠ¸ë˜í”½ì„ ë¶„ì‚°
- **í™•ì¥ì„± í™•ë³´**: ìˆ˜í‰ í™•ì¥(Scale-Out)ì„ í†µí•´ ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬ ê°€ëŠ¥
- **ê³ ê°€ìš©ì„±(High Availability) ë³´ì¥**: íŠ¹ì • ìƒ¤ë“œ ì¥ì•  ë°œìƒ ì‹œ ì „ì²´ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ë°©ì§€

---

## 2. ìƒ¤ë”© ë°©ì‹
| ìƒ¤ë”© ë°©ì‹ | ì„¤ëª… |
|-----------|------|
| **ë²”ìœ„ ê¸°ë°˜ ìƒ¤ë”© (Range-Based Sharding)** | íŠ¹ì • ë²”ìœ„ì˜ ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ ìƒ¤ë“œì— ì €ì¥ (ì˜ˆ: ID 1~1000, 1001~2000) |
| **í•´ì‹œ ê¸°ë°˜ ìƒ¤ë”© (Hash-Based Sharding)** | íŠ¹ì • í‚¤(ì˜ˆ: ì‚¬ìš©ì ID)ë¥¼ í•´ì‹œ í•¨ìˆ˜ë¡œ ë³€í™˜í•˜ì—¬ ìƒ¤ë“œ ê²°ì • |
| **ë””ë ‰í„°ë¦¬ ê¸°ë°˜ ìƒ¤ë”© (Directory-Based Sharding)** | ìƒ¤ë“œ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ì¤‘ì•™ ë””ë ‰í„°ë¦¬ë¥¼ í†µí•´ íŠ¹ì • ìƒ¤ë“œì— ë°ì´í„°ë¥¼ ì €ì¥ |
| **ì§€ë¦¬ì  ìƒ¤ë”© (Geographical Sharding)** | ì§€ì—­ë³„ ë°ì´í„°ë¥¼ í•´ë‹¹ ì§€ì—­ì˜ ìƒ¤ë“œì— ì €ì¥ |

---

## 3. ì½”ë“œ ì˜ˆì œ
### ğŸ”¹ ë°ì´í„° ìƒ¤ë”© êµ¬í˜„ ì˜ˆì œ
##### Java (Spring Boot - ìƒ¤ë”© ì ìš©)
```java
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Service;

@Service
public class ShardingService {
    private final JdbcTemplate db1;
    private final JdbcTemplate db2;

    public ShardingService(JdbcTemplate db1, JdbcTemplate db2) {
        this.db1 = db1;
        this.db2 = db2;
    }

    public void saveUser(int userId, String name) {
        JdbcTemplate selectedDb = (userId % 2 == 0) ? db1 : db2;
        selectedDb.update("INSERT INTO users (id, name) VALUES (?, ?)", userId, name);
    }
}
```

##### JavaScript (Node.js - í•´ì‹œ ê¸°ë°˜ ìƒ¤ë”© ì ìš©)
```javascript
const mysql = require('mysql2/promise');
const db1 = mysql.createPool({ host: 'db1.example.com', user: 'user', database: 'shard1' });
const db2 = mysql.createPool({ host: 'db2.example.com', user: 'user', database: 'shard2' });

async function saveUser(userId, name) {
    const db = userId % 2 === 0 ? db1 : db2;
    await db.query("INSERT INTO users (id, name) VALUES (?, ?)", [userId, name]);
}
```

##### Python (Flask - ë²”ìœ„ ê¸°ë°˜ ìƒ¤ë”© ì ìš©)
```python
import sqlite3

def get_db(user_id):
    if user_id <= 1000:
        return sqlite3.connect("shard1.db")
    else:
        return sqlite3.connect("shard2.db")

def save_user(user_id, name):
    db = get_db(user_id)
    cursor = db.cursor()
    cursor.execute("INSERT INTO users (id, name) VALUES (?, ?)", (user_id, name))
    db.commit()
    db.close()
```

---

## 4. ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”© ì‚¬ìš© ì‹œ ê³ ë ¤í•  ì 
- **ìƒ¤ë“œ ê°„ ì¡°ì¸(Join) ë¶ˆê°€ëŠ¥**: ì—¬ëŸ¬ ìƒ¤ë“œì— ê±¸ì³ ìˆëŠ” ë°ì´í„°ì˜ ì¡°ì¸ì´ ì–´ë ¤ì›€
- **ìƒ¤ë”© í‚¤(Sharding Key) ì„ ì • ì¤‘ìš”**: ê· í˜• ì¡íŒ ìƒ¤ë“œ ë¶„ë°°ë¥¼ ìœ„í•´ í•´ì‹œ ê¸°ë°˜ ë˜ëŠ” ì ì ˆí•œ ë²”ìœ„ ê¸°ì¤€ ì„¤ì • í•„ìš”
- **ìƒ¤ë“œ ì¶”ê°€ ì‹œ ë§ˆì´ê·¸ë ˆì´ì…˜ ë¬¸ì œ**: ìƒ¤ë“œë¥¼ ì¶”ê°€í•  ê²½ìš° ê¸°ì¡´ ë°ì´í„°ë¥¼ ì¬ë¶„ë°°í•´ì•¼ í•˜ëŠ” ì–´ë ¤ì›€ ì¡´ì¬
- **íŠ¸ëœì­ì…˜ ê´€ë¦¬ ì–´ë ¤ì›€**: ìƒ¤ë“œ ê°„ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ë¶„ì‚° íŠ¸ëœì­ì…˜ì´ í•„ìš”í•  ìˆ˜ ìˆìŒ

---

## 5. ë©´ì ‘ ì§ˆë¬¸ ì˜ˆì‹œ ë° ë‹µë³€

### 1ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”©ì´ë€ ë¬´ì—‡ì´ë©°, ì™œ í•„ìš”í•œê°€?
ë°ì´í„°ë² ì´ìŠ¤ ìƒ¤ë”©ì€ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ê°œì˜ ì‘ì€ ë°ì´í„°ë² ì´ìŠ¤(ìƒ¤ë“œ)ë¡œ ë‚˜ëˆ„ì–´ ì €ì¥í•˜ëŠ” ê¸°ìˆ ì´ë‹¤. ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³ , ë°ì´í„°ë² ì´ìŠ¤ì˜ í™•ì¥ì„±ì„ ë†’ì´ëŠ” ë° í•„ìš”í•˜ë‹¤.

### 2ï¸âƒ£ ë²”ìœ„ ê¸°ë°˜ ìƒ¤ë”©ê³¼ í•´ì‹œ ê¸°ë°˜ ìƒ¤ë”©ì˜ ì°¨ì´ëŠ”?
- **ë²”ìœ„ ê¸°ë°˜ ìƒ¤ë”©**: íŠ¹ì • ë²”ìœ„ì˜ ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ ìƒ¤ë“œì— ì €ì¥. ë°ì´í„°ì˜ ë¶„í¬ê°€ ë¶ˆê· í˜•í•  ìˆ˜ ìˆìŒ.
- **í•´ì‹œ ê¸°ë°˜ ìƒ¤ë”©**: í•´ì‹œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒ¤ë“œë¥¼ ê²°ì •. ë°ì´í„°ê°€ ê· ë“±í•˜ê²Œ ë¶„ë°°ë˜ì§€ë§Œ, ìƒ¤ë“œë¥¼ ì¶”ê°€í•  ê²½ìš° ê¸°ì¡´ ë°ì´í„°ì˜ ì¬ë°°ì¹˜ê°€ í•„ìš”í•  ìˆ˜ ìˆìŒ.

### 3ï¸âƒ£ ìƒ¤ë”©ì„ ì ìš©í•  ë•Œ ìƒ¤ë”© í‚¤ë¥¼ ì–´ë–»ê²Œ ì„ íƒí•´ì•¼ í•˜ëŠ”ê°€?
ìƒ¤ë”© í‚¤ëŠ” ë°ì´í„°ê°€ ê³ ë¥´ê²Œ ë¶„í¬ë˜ë„ë¡ ì„ íƒí•´ì•¼ í•œë‹¤. íŠ¹ì • ê°’(ì˜ˆ: ë‚ ì§œ) ê¸°ë°˜ ìƒ¤ë”©ì€ íŠ¹ì • ìƒ¤ë“œì— ë¶€í•˜ê°€ ì§‘ì¤‘ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ í•´ì‹œ ê¸°ë°˜ ìƒ¤ë”©ì´ ë” ë‚˜ì€ ì„ íƒì¼ ìˆ˜ ìˆë‹¤.

### 4ï¸âƒ£ ìƒ¤ë”© í™˜ê²½ì—ì„œ íŠ¸ëœì­ì…˜ì„ ì–´ë–»ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ”ê°€?
- ìƒ¤ë“œ ë‚´ì—ì„œ íŠ¸ëœì­ì…˜ì„ ìœ ì§€í•˜ëŠ” ê²ƒì´ ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•.
- ë¶„ì‚° íŠ¸ëœì­ì…˜(Distributed Transactions) ë˜ëŠ” 2PC(Two-Phase Commit)ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œê°€ ìˆì„ ìˆ˜ ìˆìŒ.

### 5ï¸âƒ£ ìƒ¤ë”©ì„ ì ìš©í•œ ì‹œìŠ¤í…œì—ì„œ ì¥ì• ê°€ ë°œìƒí•˜ë©´ ì–´ë–»ê²Œ ë³µêµ¬í•  ìˆ˜ ìˆëŠ”ê°€?
- ê°œë³„ ìƒ¤ë“œì— ëŒ€í•œ ë°±ì—… ë° ë³µêµ¬ ì „ëµì´ í•„ìš”í•¨.
- ìƒ¤ë“œ ê°„ ë°ì´í„° ë³µì œë¥¼ í™œìš©í•˜ì—¬ ì¥ì•  ì‹œ ë‹¤ë¥¸ ìƒ¤ë“œë¡œ íŠ¸ë˜í”½ì„ ë¦¬ë””ë ‰ì…˜í•  ìˆ˜ ìˆìŒ.

### 6ï¸âƒ£ ìƒ¤ë”©ê³¼ ë ˆí”Œë¦¬ì¼€ì´ì…˜(Replication)ì˜ ì°¨ì´ì ì€?
- **ìƒ¤ë”©**: ë°ì´í„°ë¥¼ ìˆ˜í‰ìœ¼ë¡œ ë¶„í• í•˜ì—¬ ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ë°©ì‹.
- **ë ˆí”Œë¦¬ì¼€ì´ì…˜**: ë™ì¼í•œ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ê°œì˜ ì„œë²„ì— ë³µì œí•˜ì—¬ ê°€ìš©ì„±ê³¼ ì½ê¸° ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ëŠ” ë°©ì‹.

### 7ï¸âƒ£ ìƒ¤ë”©ì„ ì ìš©í–ˆì„ ë•Œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œì ê³¼ í•´ê²° ë°©ë²•ì€?
- **ë°ì´í„° ë¶ˆê· í˜•** â†’ ìƒ¤ë”© í‚¤ë¥¼ ìµœì í™”í•˜ì—¬ ê· ë“±í•œ ë°ì´í„° ë¶„ë°° í•„ìš”.
- **ìƒ¤ë“œ ê°„ ì¡°ì¸ ë¶ˆê°€ëŠ¥** â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‹¨ì—ì„œ ì¡°ì¸ ë¡œì§ì„ ì²˜ë¦¬í•˜ê±°ë‚˜ NoSQLì„ ê³ ë ¤.
- **ìƒ¤ë“œ ì¶”ê°€ ì‹œ ë°ì´í„° ì´ë™ ë¬¸ì œ** â†’ ê°€ìƒ ìƒ¤ë”©(Virtual Sharding) ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ìµœì†Œí™”.

---